# GitHub Actions è‡ªåŠ¨æ„å»ºè®¾ç½®æŒ‡å—

æœ¬æŒ‡å—å°†å¸®åŠ©ä½ è®¾ç½®GitHub Actionsè‡ªåŠ¨æ„å»ºå’Œå‘å¸ƒDockeré•œåƒåˆ°Docker Hubã€‚

## ğŸš€ å¿«é€Ÿè®¾ç½®

### æ­¥éª¤1: åˆ›å»ºDocker Hubè®¿é—®ä»¤ç‰Œ

1. ç™»å½• [Docker Hub](https://hub.docker.com/)
2. ç‚¹å‡»å³ä¸Šè§’çš„ç”¨æˆ·å â†’ **Account Settings**
3. é€‰æ‹© **Security** æ ‡ç­¾é¡µ
4. ç‚¹å‡» **New Access Token**
5. è¾“å…¥ä»¤ç‰Œæè¿°ï¼ˆå¦‚ï¼š`GitHub Actions`ï¼‰
6. é€‰æ‹©æƒé™ï¼š**Read, Write, Delete**
7. ç‚¹å‡» **Generate** å¹¶**å¤åˆ¶ç”Ÿæˆçš„ä»¤ç‰Œ**ï¼ˆåªæ˜¾ç¤ºä¸€æ¬¡ï¼ï¼‰

### æ­¥éª¤2: åœ¨GitHubä»“åº“ä¸­æ·»åŠ Secrets

1. è¿›å…¥ä½ çš„GitHubä»“åº“
2. ç‚¹å‡» **Settings** æ ‡ç­¾é¡µ
3. åœ¨å·¦ä¾§èœå•ä¸­é€‰æ‹© **Secrets and variables** â†’ **Actions**
4. ç‚¹å‡» **New repository secret** æ·»åŠ ä»¥ä¸‹secretsï¼š

#### å¿…éœ€çš„Secrets

| Secretåç§° | å€¼ | è¯´æ˜ |
|-----------|-----|------|
| `DOCKERHUB_USERNAME` | ä½ çš„Docker Hubç”¨æˆ·å | ç”¨äºç™»å½•Docker Hub |
| `DOCKERHUB_TOKEN` | åˆšæ‰ç”Ÿæˆçš„è®¿é—®ä»¤ç‰Œ | ç”¨äºè®¤è¯ï¼ˆä¸æ˜¯å¯†ç ï¼ï¼‰ |

### æ­¥éª¤3: éªŒè¯è®¾ç½®

1. æ¨é€ä»£ç åˆ°`main`åˆ†æ”¯æˆ–åˆ›å»ºPull Request
2. æŸ¥çœ‹ **Actions** æ ‡ç­¾é¡µä¸­çš„å·¥ä½œæµè¿è¡ŒçŠ¶æ€
3. å¦‚æœè®¾ç½®æ­£ç¡®ï¼Œä½ åº”è¯¥çœ‹åˆ°ï¼š
   - âœ… æ„å»ºæˆåŠŸ
   - âœ… é•œåƒæ¨é€åˆ°Docker Hubï¼ˆä»…é™mainåˆ†æ”¯ï¼‰

## ğŸ”§ å·¥ä½œæµè¯´æ˜

### è§¦å‘æ¡ä»¶

å·¥ä½œæµåœ¨ä»¥ä¸‹æƒ…å†µä¸‹è‡ªåŠ¨è¿è¡Œï¼š
- æ¨é€åˆ° `main` æˆ– `develop` åˆ†æ”¯
- åˆ›å»ºç‰ˆæœ¬æ ‡ç­¾ï¼ˆå¦‚ `v1.0.0`ï¼‰
- åˆ›å»ºPull Requeståˆ° `main` åˆ†æ”¯

### æ„å»ºè¡Œä¸º

| è§¦å‘æ¡ä»¶ | æ„å»º | æ¨é€åˆ°Docker Hub | æ ‡ç­¾ | è¯´æ˜ |
|---------|------|----------------|------|------|
| Pushåˆ°mainåˆ†æ”¯ | âœ… | âœ…* | `latest` | *éœ€è¦Docker Hubå‡­æ® |
| Pushåˆ°developåˆ†æ”¯ | âœ… | âœ…* | `develop` | *éœ€è¦Docker Hubå‡­æ® |
| åˆ›å»ºç‰ˆæœ¬æ ‡ç­¾ | âœ… | âœ…* | ç‰ˆæœ¬å·ï¼ˆå¦‚`v1.0.0`, `1.0`, `1`ï¼‰ | *éœ€è¦Docker Hubå‡­æ® |
| Pull Request | âœ… | âŒ | ä»…æ„å»ºæµ‹è¯• | æ°¸è¿œä¸æ¨é€ |
| æ— Docker Hubå‡­æ® | âœ… | âŒ | ä»…æ„å»ºæµ‹è¯• | å®‰å…¨åœ°è·³è¿‡æ¨é€æ­¥éª¤ |

### æ”¯æŒçš„æ¶æ„

- `linux/amd64` (x86_64)
- `linux/arm64` (ARM64)

## ğŸ› ï¸ è‡ªå®šä¹‰é…ç½®

### ä¿®æ”¹é•œåƒåç§°

ç¼–è¾‘ `.github/workflows/docker-build.yml` æ–‡ä»¶ï¼š

```yaml
env:
  REGISTRY: docker.io
  IMAGE_NAME: your-custom-image-name  # ä¿®æ”¹è¿™é‡Œ
```

### ä¿®æ”¹è§¦å‘åˆ†æ”¯

```yaml
on:
  push:
    branches:
      - main
      - your-branch  # æ·»åŠ å…¶ä»–åˆ†æ”¯
```

### æ·»åŠ è‡ªå®šä¹‰æ ‡ç­¾

```yaml
tags: |
  type=ref,event=branch
  type=ref,event=pr
  type=semver,pattern={{version}}
  type=raw,value=custom-tag  # æ·»åŠ è‡ªå®šä¹‰æ ‡ç­¾
```

## ğŸš¨ æ•…éšœæ’é™¤

### å¸¸è§é”™è¯¯

#### 1. "Username and password required"
**åŸå› **: ç¼ºå°‘Docker Hubå‡­æ®
**è§£å†³**: ç¡®ä¿å·²æ·»åŠ  `DOCKERHUB_USERNAME` å’Œ `DOCKERHUB_TOKEN` secrets
**æ³¨æ„**: æ–°ç‰ˆæœ¬çš„å·¥ä½œæµä¼šè‡ªåŠ¨è·³è¿‡æ¨é€æ­¥éª¤å¦‚æœæ²¡æœ‰å‡­æ®

#### 2. "denied: requested access to the resource is denied"
**åŸå› **: Docker Hubæƒé™ä¸è¶³æˆ–ç”¨æˆ·åé”™è¯¯
**è§£å†³**: 
- æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦æ­£ç¡®
- ç¡®ä¿è®¿é—®ä»¤ç‰Œæœ‰å†™å…¥æƒé™
- éªŒè¯ä»“åº“åç§°æ ¼å¼ï¼š`username/repository`

#### 3. "repository does not exist"
**åŸå› **: Docker Hubä¸Šä¸å­˜åœ¨å¯¹åº”çš„ä»“åº“
**è§£å†³**: 
- åœ¨Docker Hubä¸Šåˆ›å»ºä»“åº“
- æˆ–è€…è®©GitHub Actionsè‡ªåŠ¨åˆ›å»ºï¼ˆé¦–æ¬¡æ¨é€æ—¶ï¼‰

#### 4. æ„å»ºæˆåŠŸä½†æ²¡æœ‰æ¨é€
**åŸå› **: è¿™æ˜¯æ­£å¸¸è¡Œä¸ºï¼Œå½“ï¼š
- æ˜¯Pull Requestæ—¶ï¼ˆå®‰å…¨è€ƒè™‘ï¼‰
- ç¼ºå°‘Docker Hubå‡­æ®æ—¶
**è§£å†³**: æ£€æŸ¥æ—¥å¿—ä¸­çš„æç¤ºä¿¡æ¯

### è°ƒè¯•æ­¥éª¤

1. **æŸ¥çœ‹å·¥ä½œæµæ—¥å¿—**ï¼š
   - è¿›å…¥ **Actions** æ ‡ç­¾é¡µ
   - ç‚¹å‡»å¤±è´¥çš„å·¥ä½œæµè¿è¡Œ
   - æŸ¥çœ‹è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯

2. **éªŒè¯Secrets**ï¼š
   ```bash
   # åœ¨å·¥ä½œæµä¸­æ·»åŠ è°ƒè¯•æ­¥éª¤ï¼ˆæ³¨æ„ï¼šä¸è¦æ‰“å°å®é™…çš„secretå€¼ï¼‰
   - name: Debug secrets
     run: |
       echo "Username exists: ${{ secrets.DOCKERHUB_USERNAME != '' }}"
       echo "Token exists: ${{ secrets.DOCKERHUB_TOKEN != '' }}"
   ```

3. **æœ¬åœ°æµ‹è¯•Dockeræ„å»º**ï¼š
   ```bash
   docker build -t test-image .
   docker run --rm test-image
   ```

## ğŸ”’ å®‰å…¨æœ€ä½³å®è·µ

### 1. ä½¿ç”¨è®¿é—®ä»¤ç‰Œè€Œéå¯†ç 
- âœ… ä½¿ç”¨Docker Hubè®¿é—®ä»¤ç‰Œ
- âŒ ä¸è¦ä½¿ç”¨è´¦æˆ·å¯†ç 

### 2. é™åˆ¶ä»¤ç‰Œæƒé™
- åªæˆäºˆå¿…è¦çš„æƒé™
- å®šæœŸè½®æ¢è®¿é—®ä»¤ç‰Œ

### 3. ä¿æŠ¤Secrets
- ä¸è¦åœ¨ä»£ç ä¸­ç¡¬ç¼–ç secrets
- ä¸è¦åœ¨æ—¥å¿—ä¸­æ‰“å°secretå€¼
- å®šæœŸå®¡æŸ¥å’Œæ›´æ–°secrets

### 4. åˆ†æ”¯ä¿æŠ¤
- å¯¹mainåˆ†æ”¯å¯ç”¨ä¿æŠ¤è§„åˆ™
- è¦æ±‚Pull Requestå®¡æŸ¥
- è¦æ±‚çŠ¶æ€æ£€æŸ¥é€šè¿‡

## ğŸ“Š ç›‘æ§å’Œç»´æŠ¤

### 1. å®šæœŸæ£€æŸ¥
- ç›‘æ§å·¥ä½œæµè¿è¡ŒçŠ¶æ€
- æ£€æŸ¥Docker Hubé•œåƒå¤§å°å’Œå±‚æ•°
- éªŒè¯å¤šæ¶æ„æ„å»º

### 2. æ€§èƒ½ä¼˜åŒ–
- ä½¿ç”¨æ„å»ºç¼“å­˜
- ä¼˜åŒ–Dockerfileå±‚
- è€ƒè™‘ä½¿ç”¨å¤šé˜¶æ®µæ„å»º

### 3. æ›´æ–°ä¾èµ–
- å®šæœŸæ›´æ–°GitHub Actionsç‰ˆæœ¬
- æ›´æ–°åŸºç¡€é•œåƒ
- æ›´æ–°æ„å»ºå·¥å…·

## ğŸ¯ ä¸‹ä¸€æ­¥

è®¾ç½®å®Œæˆåï¼Œä½ å¯ä»¥ï¼š

1. **è‡ªåŠ¨åŒ–éƒ¨ç½²**: ç»“åˆå…¶ä»–å·¥å…·å®ç°è‡ªåŠ¨éƒ¨ç½²
2. **æ·»åŠ æµ‹è¯•**: åœ¨æ„å»ºå‰è¿è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•
3. **é€šçŸ¥é›†æˆ**: æ·»åŠ Slackã€é‚®ä»¶ç­‰é€šçŸ¥
4. **å®‰å…¨æ‰«æ**: é›†æˆå®¹å™¨å®‰å…¨æ‰«æå·¥å…·

## ğŸ“ è·å–å¸®åŠ©

å¦‚æœé‡åˆ°é—®é¢˜ï¼š

1. æŸ¥çœ‹ [GitHub Actionsæ–‡æ¡£](https://docs.github.com/en/actions)
2. æŸ¥çœ‹ [Docker Hubæ–‡æ¡£](https://docs.docker.com/docker-hub/)
3. åœ¨é¡¹ç›®ä¸­åˆ›å»ºIssueå¹¶æä¾›è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯

---

**æç¤º**: é¦–æ¬¡è®¾ç½®å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿæ¥éªŒè¯æ‰€æœ‰é…ç½®ã€‚è¯·è€å¿ƒç­‰å¾…å¹¶æŸ¥çœ‹å·¥ä½œæµæ—¥å¿—ä»¥ç¡®è®¤ä¸€åˆ‡æ­£å¸¸è¿è¡Œã€‚
